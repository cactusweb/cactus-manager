<div class="content content-table">
        

    <div class="header">
        <button class="adding-btn standart-btn outline-danger" (click)="resetPoints()">
            Reset
        </button>

        <select class="sort" [(ngModel)]="sortParam" (ngModelChange)="onSortChange()">
            <option value="" selected>Sort</option>
            <option value="expires_in-false-date">Renewal up</option>
            <option value="expires_in-true-date">Renewal down</option>
        </select>
        
        <div class="search">
            <input type="text" placeholder="Search" name="search" id="search" class="search-input" autocomplete="off" [(ngModel)]="searchParam" >
            <img src="/assets/img/icons/search.svg">
        </div>
    </div>

    <span class="hr grey"></span>


    <div class="keys">


        <table>
            <thead>
                <tr>
                    <th>Nickname</th>
                    <th>Key</th>
                    <th>Type</th>
                    <th>Info</th>
                    <th style="display: grid; justify-content: end;">Points</th>
                </tr>
            </thead>
        </table>

        <cdk-virtual-scroll-viewport class="custom-scroll" itemSize="32" *ngIf="licenses[0]"> 
            <table>
                <tr class="license" *cdkVirtualFor="let license of licenses
                    | search : searchKeys : searchParam
                    | sort : sortParam
                    , let i = index, trackBy: trackByFn"
                >
                    <td (click)="infoLicense = license" class="pointer"> {{ license.user?.full_name }} </td>
                    <td class="key"> 
                        
                        ...****
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="17" viewBox="0 0 14 17" fill="none" alt="copy" class="pointer" (click)="copyData(license.key)">
                            <path d="M9.50997 2.97316H1.3821C0.619437 2.97316 0 3.57545 0 4.31701V15.6562C0 16.3977 0.619437 17 1.3821 17H9.50997C10.2726 17 10.8921 16.3977 10.8921 15.6562V4.31701C10.8885 3.57545 10.2691 2.97316 9.50997 2.97316ZM9.92174 15.6527C9.92174 15.8755 9.73555 16.0565 9.50639 16.0565H1.37852C1.14936 16.0565 0.963171 15.8755 0.963171 15.6527V4.31701C0.963171 4.09419 1.14936 3.91316 1.37852 3.91316H9.50639C9.73555 3.91316 9.92174 4.09419 9.92174 4.31701V15.6527Z" fill="#3D3D3D"/>
                            <path d="M12.6179 0H4.49003C3.72737 0 3.10793 0.602294 3.10793 1.34385C3.10793 1.60496 3.32276 1.81385 3.5913 1.81385C3.85985 1.81385 4.07468 1.60496 4.07468 1.34385C4.07468 1.12103 4.26087 0.939997 4.49003 0.939997H12.6179C12.8471 0.939997 13.0332 1.12103 13.0332 1.34385V12.683C13.0332 12.9058 12.8471 13.0868 12.6179 13.0868C12.3494 13.0868 12.1345 13.2957 12.1345 13.5568C12.1345 13.818 12.3494 14.0268 12.6179 14.0268C13.3806 14.0268 14 13.4245 14 12.683V1.34385C14 0.602294 13.3806 0 12.6179 0Z" fill="#3D3D3D"/>
                        </svg>

                    </td>
                    <td> {{ license.type }} </td>
                    <td class=""> 
                        <svg xmlns="http://www.w3.org/2000/svg" (click)="infoLicense = license" width="17" height="17" viewBox="0 0 17 17" fill="none" alt="info" class="pointer info">
                            <path d="M8.5 0C3.8131 0 0 3.81315 0 8.50005C0 13.187 3.8131 17 8.5 17C13.1869 17 17 13.187 17 8.50005C17 3.81315 13.1869 0 8.5 0ZM8.5 15.4545C4.66521 15.4545 1.54545 12.3348 1.54545 8.50005C1.54545 4.66532 4.66521 1.54545 8.5 1.54545C12.3348 1.54545 15.4545 4.66532 15.4545 8.50005C15.4545 12.3348 12.3347 15.4545 8.5 15.4545Z" fill="#3D3D3D"/>
                            <path d="M8.4999 3.60606C7.93189 3.60606 7.4698 4.06846 7.4698 4.63683C7.4698 5.20468 7.93189 5.66667 8.4999 5.66667C9.0679 5.66667 9.52999 5.20468 9.52999 4.63683C9.52999 4.06846 9.0679 3.60606 8.4999 3.60606Z" fill="#3D3D3D"/>
                            <path d="M8.5 7.21212C8.07325 7.21212 7.72727 7.5581 7.72727 7.98485V12.6212C7.72727 13.048 8.07325 13.3939 8.5 13.3939C8.92675 13.3939 9.27273 13.048 9.27273 12.6212V7.98485C9.27273 7.5581 8.92675 7.21212 8.5 7.21212Z" fill="#3D3D3D"/>
                        </svg>
                    </td>
                    
                    <td class="action">
                        <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" class="pointer renew" viewBox="0 0 19 19" fill="none" (click)="resetPoints(license)">
                            <path d="M18 9.5C18 14.1944 14.1944 18 9.5 18C4.80558 18 1 14.1944 1 9.5C1 4.80558 4.80558 1 9.5 1C12.9 1 14.175 3.55 15.45 4.825M15.45 4.825V1M15.45 4.825H12.05" stroke="#3D3D3D" stroke-width="1.2" stroke-linecap="round"/>
                        </svg>
                    </td>
                </tr >
            </table>
        </cdk-virtual-scroll-viewport>

    </div>

    <app-license-info *ngIf="infoLicense" (onClose)="onClose($event)" [license]="infoLicense"></app-license-info>
</div>

<app-load-error *ngIf="load_error" (onRefresh)="getLicenses()"></app-load-error>

<ngx-spinner
    type="ball-clip-rotate"
    size="large"
    zIndex='1'
    [fullScreen]="false"
></ngx-spinner>